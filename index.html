<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Tienda - GAMER M&M </title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* Estilos personalizados sencillos para darle personalidad */
    :root{
      --accent:#6f42c1;
      --muted:#f8f9fa;
    }
    body{background:linear-gradient(180deg,#ffffff 0%, #f7f0ff 100%);font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    .product-card{border-radius:16px;box-shadow:0 6px 18px rgba(111,66,193,0.12);overflow:hidden}
    .badge-price{background:linear-gradient(90deg, rgba(111,66,193,0.12), rgba(111,66,193,0.06));color:var(--accent);font-weight:600}
    .cart-empty{opacity:.7}
    .cart-item-qty{width:72px}
    @media (max-width:575px){
      .product-title{font-size:.95rem}
    }
  </style>
</head>
<body>
<div class="container py-4">
  <header class="d-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0">Tienda Gamer M&M ðŸŽ® </h1>
    <div>
      <button class="btn btn-outline-secondary me-2" id="btn-view-cart" data-bs-toggle="offcanvas" data-bs-target="#offcanvasCart">Ver carrito <span id="count-badge" class="badge bg-secondary ms-1">0</span></button>
    </div>
  </header>

  <section>
    <h2 class="h5 mb-3">Productos</h2>
    <div id="productos" class="row row-cols-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5 g-4"></div>
  
  </section>

  <hr class="my-4">
  <footer class="text-muted small">Creado por Oriana Moyano y Santiago Marranti â€”  Programacion I- 1er aÃ±o Programacion Full Stack UPC.</footer>
</div>

<!-- Offcanvas: carrito -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasCart">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title">Tu carrito</h5>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"></button>
  </div>
  <div class="offcanvas-body d-flex flex-column">
    <div id="carrito-list" class="list-group mb-3"></div>
    <div class="mt-auto">
      <p class="mb-2">Total: <strong id="total">$0</strong></p>
      <div class="d-flex gap-2">
        <button class="btn btn-danger flex-grow-1" id="btn-empty">Vaciar carrito</button>
        <button class="btn btn-success" id="btn-checkout">Pagar</button>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap JS (y dependencias) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
// --- Datos de ejemplo (puedes editarlos o cargarlos desde JSON externo) ---
const productos = [
  {id:1, nombre:'Auriculares inalÃ¡mbricos', precio:54999, img:'https://m.media-amazon.com/images/I/71F2ccIPPLL._AC_SL1500_.jpg'},
  {id:2, nombre:'Silla gamer', precio:199200, img:'https://i.blogs.es/cdab8d/silla-gaming-gtplayer/450_1000.webp'},
  {id:3, nombre:'Mouse gamer Redragon ', precio:22999, img:'https://m.media-amazon.com/images/I/61C7blR0ZAL._AC_SL1500_.jpg'},
  {id:4, nombre:'Mochila urbana,para notebook', precio:15999, img:'https://http2.mlstatic.com/D_NQ_NP_847588-MLU75357217789_032024-O.webp'},
  {id:5, nombre:'Soporte para laptop', precio:9999, img:'https://http2.mlstatic.com/D_NQ_NP_874688-MLA78863543696_092024-O.webp'},
  {id:6, nombre:'Cargador USB-C 65W', precio:11999, img:'https://http2.mlstatic.com/D_NQ_NP_738296-MLA84095782178_052025-O.webp'},
  {id:7, nombre:'Monitor gamer', precio:199200, img:'https://app.contabilium.com/files/explorer/48428/Productos-Servicios/concepto-14045258.jpg'},
  {id:8, nombre:'Teclado mecÃ¡nico compacto', precio:74999, img:'https://acdn-us.mitiendanube.com/stores/001/717/384/products/pmechanic-1-pica-4a6c4821b3f49780c517555283820785-480-0.png'},
  {id:9, nombre:'Gafas VR', precio:81999, img:' https://images.ecestaticos.com/MEIpDb1IU1-W-Nssibts9QRbKnA=/0x0:640x361/1440x810/filters:fill(white):format(jpg)/f.elconfidencial.com%2Foriginal%2Fdfb%2Fdcc%2F863%2Fdfbdcc86309f31d5b119ea5180472621.jpg'},
  {id:10, nombre: 'Joystick ps5', precio:158900, img:'https://nextgames.com.ar/img/Public/1040/77913-producto-61mkouq8cel-sl1500.jpg'},
  {id:11, nombre: 'Luces led',precio: 15900, img: 'https://http2.mlstatic.com/tira-de-luces-led-rgb-con-control-remoto-164-ft-D_NQ_NP_648074-MLM41922398493_052020-F.jpg'},
  {id:12, nombre: 'Escritorio moderno para pc',precio: 298900, img: 'https://m.media-amazon.com/images/I/71mYyAgjy9L._AC_SL1500_.jpg'},
  {id:13, nombre: 'Tarjetas graficas',precio: 358900, img: 'https://www.profesionalreview.com/wp-content/uploads/2018/03/Las-tarjetas-gr%C3%A1ficas-actuales-se-enfrentan-a-las-generaciones-anteriores.jpg'},
  {id:13, nombre: 'Disco duro externo',precio: 199800, img: 'https://media.adeo.com/media/1866147/format/jpeg'},
  {id:14, nombre: 'Gabinete gamer',precio: 548900, img: 'https://tecnaninfo.com.br/wp-content/uploads/2023/01/gabinete-gamer-superframe-storm-mid-tower-rgb-vidro-temperado-atx-sem-fonte-sem-fan_146702-1024x1024.jpg'},
  {id:15, nombre: 'Camara HD 1080P',precio: 189000, img: 'https://m.media-amazon.com/images/I/61jvLcpcASL._AC_SL1500_.jpg'},
  {id:16, nombre: 'Microfono usb',precio: 190000, img: 'https://www.megatone.net/images/Articulos/zoom2x/355/MKT0091EBX.jpg'},
  {id:17, nombre: 'Playstation 5', precio: 1950900, img:'https://i5.walmartimages.com/seo/Sony-PlayStation-5-Video-Game-Console-Ps5-Disc-Console-Japanese-Edition-New_1536c1c9-0c26-4ce6-a5e1-1825ca064d05.1434e86832a815bb366d12b0a854390d.jpeg'},
  {id:18, nombre: 'Consola Xbox', precio:1589000, img:'https://i5.walmartimages.com/seo/Xbox-Series-X-Video-Game-Console-Black-Bundle_89d1cc3b-aaad-4283-a15b-71288b1a09b5.173c31c2a51119206f128fd122e78e4c.jpeg'},
  {id:19, nombre: 'Lampara gamer acrilica', precio:120000, img:'https://m.media-amazon.com/images/I/81+5lAWGF7L._AC_SX466_.jpg'},
];


const STORAGE_KEY = 'miCarrito';
let carrito = cargarCarrito();

// --- Render Productos ---
function renderProductos(){
  const cont = document.getElementById('productos');
  cont.innerHTML = '';
  productos.forEach(p => {
    const card = document.createElement('div');
    card.className = 'card product-card p-0';
    card.style.width = '220px';
    card.innerHTML = `
      <img src="${p.img}" class="card-img-top" alt="${p.nombre}">
      <div class="card-body">
        <h3 class="h6 product-title">${p.nombre}</h3>
        <p class="mb-2"><span class="badge badge-price">${formatPrecio(p.precio)}</span></p>
        <div class="d-flex gap-2">
          <button class="btn btn-sm btn-primary flex-grow-1" onclick="agregarAlCarrito(${p.id})">Agregar</button>
          <button class="btn btn-sm btn-outline-secondary" onclick="verDetalles(${p.id})">Ver</button>
        </div>
      </div>
    `;
    cont.appendChild(card);
  });
}

function verDetalles(id){
  const p = productos.find(x=>x.id===id);
  alert(`${p.nombre}\nPrecio: ${formatPrecio(p.precio)}`);
}

// --- Carrito: CRUD y persistencia ---
function guardarCarrito(){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(carrito));
  actualizarBadgeCount();
}

function cargarCarrito(){
  try{
    const raw = localStorage.getItem(STORAGE_KEY);
    return raw ? JSON.parse(raw) : [];
  }catch(e){
    console.error('Error leyendo localStorage',e);
    return [];
  }
}

function agregarAlCarrito(id){
  const prod = productos.find(p=>p.id===id);
  if(!prod) return;
  const existente = carrito.find(i=>i.id===id);
  if(existente){ existente.cantidad += 1; }
  else{ carrito.push({id:prod.id, nombre:prod.nombre, precio:prod.precio, cantidad:1}); }
  guardarCarrito();
  renderCarrito();
  mostrarToast(`${prod.nombre} agregado al carrito`);
}

function eliminarDelCarrito(id){
  carrito = carrito.filter(i=>i.id!==id);
  guardarCarrito();
  renderCarrito();
}

function modificarCantidad(id, nuevaCantidad){
  nuevaCantidad = Number(nuevaCantidad);
  if(isNaN(nuevaCantidad) || nuevaCantidad < 1){
    // si el usuario pone 0 o menor, lo eliminamos
    eliminarDelCarrito(id);
    return;
  }
  const item = carrito.find(i=>i.id===id);
  if(item){ item.cantidad = nuevaCantidad; guardarCarrito(); renderCarrito(); }
}

function vaciarCarrito(){
  if(!confirm('Â¿Seguro que querÃ©s vaciar el carrito?')) return;
  carrito = [];
  guardarCarrito();
  renderCarrito();
}

// --- Render Carrito en offcanvas ---
function renderCarrito(){
  const list = document.getElementById('carrito-list');
  list.innerHTML = '';
  if(carrito.length === 0){
    list.innerHTML = `<div class="text-center p-4 cart-empty">Tu carrito estÃ¡ vacÃ­o</div>`;
    document.getElementById('total').textContent = formatPrecio(0);
    actualizarBadgeCount();
    return;
  }
  carrito.forEach(item => {
    const el = document.createElement('div');
    el.className = 'list-group-item d-flex align-items-center justify-content-between gap-3';
    el.innerHTML = `
      <div class="me-2">
        <div class="fw-semibold">${item.nombre}</div>
        <small class="text-muted">${formatPrecio(item.precio)}</small>
      </div>
      <div class="d-flex align-items-center gap-2">
        <input type="number" min="1" value="${item.cantidad}" class="form-control form-control-sm cart-item-qty" onchange="modificarCantidad(${item.id}, this.value)">
        <div class="text-end">
          <div>${formatPrecio(item.precio * item.cantidad)}</div>
          <button class="btn btn-sm btn-link text-danger p-0" onclick="eliminarDelCarrito(${item.id})">Eliminar</button>
        </div>
      </div>
    `;
    list.appendChild(el);
  });
  const total = carrito.reduce((s,i)=> s + i.precio * i.cantidad, 0);
  document.getElementById('total').textContent = formatPrecio(total);
  actualizarBadgeCount();
}

function actualizarBadgeCount(){
  const count = carrito.reduce((s,i)=> s + i.cantidad, 0);
  document.getElementById('count-badge').textContent = count;
}

function formatPrecio(n){
  return n.toLocaleString('es-AR', {style:'currency', currency:'ARS'});
}

// --- Interacciones UX ---
function mostrarToast(msg){
  // simple feedback sin dependencias extra
  const toast = document.createElement('div');
  toast.className = 'position-fixed bottom-0 end-0 p-3';
  toast.style.zIndex = 1080;
  toast.innerHTML = `<div class="toast show align-items-center text-bg-light border-0"><div class="d-flex"><div class="toast-body">${msg}</div><button type=\"button\" class=\"btn-close me-2 m-auto\" onclick=\"this.closest(\'div.position-fixed\').remove()\"></button></div></div>`;
  document.body.appendChild(toast);
  setTimeout(()=>{ toast.remove(); }, 2500);
}

// --- Eventos de botones ---
window.addEventListener('load', ()=>{
  renderProductos();
  renderCarrito();
  document.getElementById('btn-empty').addEventListener('click', vaciarCarrito);
  document.getElementById('btn-checkout').addEventListener('click', ()=>alert('Simulando pago... (aquÃ­ integrarÃ­as el metodo de pago)'));
  // tema simple
  document.getElementById('btn-theme').addEventListener('click', ()=>{
    document.body.classList.toggle('bg-dark');
    document.body.classList.toggle('text-white');
  });
});

</script>
</body>
</html>
